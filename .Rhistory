#-------------------------------------------------------------------------------
# Annual Data
annual_barplot <- ggplot(annual_temps, aes(x = year, y = annual_mean, fill = annual_mean)) +
geom_col(width = 1) +
geom_line(aes(y = moving_avg, group = 1, color = "Moving Average"), size = 1) +
geom_line(aes(y = overall_value_mean, group = 1, color = "Mean for Period"), size = 1) +
labs(title = "Annual Average Temperatures",
subtitle = "California, 1992-2020",
x = "Year",
y = "Temperature (°F)",
color = "Legend") +
theme_minimal() +
theme(plot.margin = margin(1, 1, 2, 1, "cm"))
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)) +
scale_x_discrete(labels = annual_temps$label) +
coord_cartesian(ylim = c(55, 63), clip = "off") +
scale_fill_gradient2(low = "yellow",
mid = "orange",
high = "red",
midpoint = overall_value_mean,
limits = c(min(annual_temps$annual_mean, na.rm = TRUE),
max(annual_temps$annual_mean, na.rm = TRUE)),
name = "Temperature (°F)") +
scale_color_manual(values = c("Moving Average" = "darkred",
"Mean for Period" = "darkblue"))
print(annual_barplot)
1
#-------------------------------------------------------------------------------
# Annual Data
annual_barplot <- ggplot(annual_temps, aes(x = year, y = annual_mean, fill = annual_mean)) +
geom_col(width = 1) +
geom_line(aes(y = moving_avg, group = 1, color = "Moving Average"), size = 1) +
geom_line(aes(y = overall_value_mean, group = 1, color = "Mean for Period"), size = 1) +
labs(title = "Annual Average Temperatures",
subtitle = "California, 1992-2020",
x = "Year",
y = "Temperature (°F)",
color = "Legend") +
theme_minimal() +
theme(plot.margin = margin(1, 1, 1, 1, "cm"))
#-------------------------------------------------------------------------------
# Annual Data
annual_barplot <- ggplot(annual_temps, aes(x = year, y = annual_mean, fill = annual_mean)) +
geom_col(width = 1) +
geom_line(aes(y = moving_avg, group = 1, color = "Moving Average"), size = 1) +
geom_line(aes(y = overall_value_mean, group = 1, color = "Mean for Period"), size = 1) +
labs(title = "Annual Average Temperatures",
subtitle = "California, 1992-2020",
x = "Year",
y = "Temperature (°F)",
color = "Legend") +
theme_minimal() +
theme(plot.margin = margin(1, 1, 2, 1, "cm")) +
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)) +
scale_x_discrete(labels = annual_temps$label) +
coord_cartesian(ylim = c(55, 63), clip = "off") +
scale_fill_gradient2(low = "yellow",
mid = "orange",
high = "red",
midpoint = overall_value_mean,
limits = c(min(annual_temps$annual_mean, na.rm = TRUE),
max(annual_temps$annual_mean, na.rm = TRUE)),
name = "Temperature (°F)") +
scale_color_manual(values = c("Moving Average" = "darkred",
"Mean for Period" = "darkblue"))
print(annual_barplot)
#-------------------------------------------------------------------------------
# Annual Data
annual_barplot <- ggplot(annual_temps, aes(x = year, y = annual_mean, fill = annual_mean)) +
geom_col(width = 1) +
geom_line(aes(y = moving_avg, group = 1, color = "Moving Average"), size = 1) +
geom_line(aes(y = overall_value_mean, group = 1, color = "Mean for Period"), size = 1) +
labs(title = "Annual Average Temperatures",
subtitle = "California, 1992-2020",
x = "Year",
y = "Temperature (°F)",
color = "Legend") +
theme_minimal() +
theme(plot.margin = margin(1, 1, 1, 1, "cm")) +
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)) +
scale_x_discrete(labels = annual_temps$label) +
coord_cartesian(ylim = c(55, 63), clip = "off") +
scale_fill_gradient2(low = "yellow",
mid = "orange",
high = "red",
midpoint = overall_value_mean,
limits = c(min(annual_temps$annual_mean, na.rm = TRUE),
max(annual_temps$annual_mean, na.rm = TRUE)),
name = "Temperature (°F)") +
scale_color_manual(values = c("Moving Average" = "darkred",
"Mean for Period" = "darkblue"))
print(annual_barplot)
#-------------------------------------------------------------------------------
# Annual Data
annual_barplot <- ggplot(annual_temps, aes(x = year, y = annual_mean, fill = annual_mean)) +
geom_col(width = 1) +
geom_line(aes(y = moving_avg, group = 1, color = "Moving Average"), size = 1) +
geom_line(aes(y = overall_value_mean, group = 1, color = "Mean for Period"), size = 1) +
labs(title = "Annual Average Temperatures",
subtitle = "California, 1992-2020",
x = "Year",
y = "Temperature (°F)",
color = "Legend") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)) +
scale_x_discrete(labels = annual_temps$label) +
coord_cartesian(ylim = c(55, 63), clip = "off") +
scale_fill_gradient2(low = "yellow",
mid = "orange",
high = "red",
midpoint = overall_value_mean,
limits = c(min(annual_temps$annual_mean, na.rm = TRUE),
max(annual_temps$annual_mean, na.rm = TRUE)),
name = "Temperature (°F)") +
scale_color_manual(values = c("Moving Average" = "darkred",
"Mean for Period" = "darkblue"))
print(annual_barplot)
#-------------------------------------------------------------------------------
# Annual Data
annual_barplot <- ggplot(annual_temps, aes(x = year, y = annual_mean, fill = annual_mean)) +
geom_col(width = 1) +
geom_line(aes(y = moving_avg, group = 1, color = "Moving Average"), size = 1) +
geom_line(aes(y = overall_value_mean, group = 1, color = "Mean for Period"), size = 1) +
labs(title = "Annual Average Temperatures",
subtitle = "California, 1992-2020",
x = "Year",
y = "Temperature (°F)",
color = "Legend") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)) +
scale_x_discrete(labels = annual_temps$label) +
coord_cartesian(ylim = c(55, 63), clip = "off") +
scale_fill_gradient2(low = "yellow",
mid = "orange",
high = "red",
midpoint = overall_value_mean,
limits = c(min(annual_temps$annual_mean, na.rm = TRUE),
max(annual_temps$annual_mean, na.rm = TRUE)),
name = "Temperature (°F)") +
scale_color_manual(values = c("Moving Average" = "darkred",
"Mean for Period" = "darkblue")) +
theme(plot.margin = margin(1, 1, 1, 1, "cm"))
print(annual_barplot)
#-------------------------------------------------------------------------------
# Annual Data
annual_barplot <- ggplot(annual_temps, aes(x = year, y = annual_mean, fill = annual_mean)) +
geom_col(width = 1) +
geom_line(aes(y = moving_avg, group = 1, color = "Moving Average"), size = 1) +
geom_line(aes(y = overall_value_mean, group = 1, color = "Mean for Period"), size = 1) +
labs(title = "Annual Average Temperatures",
subtitle = "California, 1992-2020",
x = "Year",
y = "Temperature (°F)",
color = "Legend") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)) +
scale_x_discrete(labels = annual_temps$label) +
coord_cartesian(ylim = c(55, 63), clip = "off") +
scale_fill_gradient2(low = "yellow",
mid = "orange",
high = "red",
midpoint = overall_value_mean,
limits = c(min(annual_temps$annual_mean, na.rm = TRUE),
max(annual_temps$annual_mean, na.rm = TRUE)),
name = "Temperature (°F)") +
scale_color_manual(values = c("Moving Average" = "darkred",
"Mean for Period" = "darkblue"))
print(annual_barplot)
#-------------------------------------------------------------------------------
# Annual Data
annual_barplot <- ggplot(annual_temps, aes(x = year, y = annual_mean, fill = annual_mean)) +
geom_col(width = 1) +
geom_line(aes(y = moving_avg, group = 1, color = "Moving Average"), size = 1) +
geom_line(aes(y = overall_value_mean, group = 1, color = "Mean for Period"), size = 1) +
labs(title = "Annual Average Temperatures",
subtitle = "California, 1992-2020",
x = "Year",
y = "Temperature (°F)",
color = "Legend") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)) +
scale_x_discrete(labels = annual_temps$label) +
scale_fill_gradient2(low = "yellow",
mid = "orange",
high = "red",
midpoint = overall_value_mean,
limits = c(min(annual_temps$annual_mean, na.rm = TRUE),
max(annual_temps$annual_mean, na.rm = TRUE)),
name = "Temperature (°F)") +
scale_color_manual(values = c("Moving Average" = "darkred",
"Mean for Period" = "darkblue"))
print(annual_barplot)
coord_cartesian(ylim = c(55, 63), clip = "off") +
#-------------------------------------------------------------------------------
# Annual Data
annual_barplot <- ggplot(annual_temps, aes(x = year, y = annual_mean, fill = annual_mean)) +
geom_col(width = 1) +
geom_line(aes(y = moving_avg, group = 1, color = "Moving Average"), size = 1) +
geom_line(aes(y = overall_value_mean, group = 1, color = "Mean for Period"), size = 1) +
labs(title = "Annual Average Temperatures",
subtitle = "California, 1992-2020",
x = "Year",
y = "Temperature (°F)",
color = "Legend") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)) +
scale_x_discrete(labels = annual_temps$label) +
coord_cartesian(ylim = c(55, 63), clip = "off") +
scale_fill_gradient2(low = "yellow",
mid = "orange",
high = "red",
midpoint = overall_value_mean,
limits = c(min(annual_temps$annual_mean, na.rm = TRUE),
max(annual_temps$annual_mean, na.rm = TRUE)),
name = "Temperature (°F)") +
scale_color_manual(values = c("Moving Average" = "darkred",
"Mean for Period" = "darkblue"))
print(annual_barplot)
#-------------------------------------------------------------------------------
# Monthly Data
monthly_barplot <- ggplot(monthly_temps, aes(x = year_month, y = value, fill = value)) +
geom_col(width = 1) +  # width = 1 for no gaps
geom_line(aes(y = temp_mv_avg, group = 1, color = "Moving Average"), size = 1) +
geom_line(aes(y = overall_value_mean, group = 1, color = "Mean for Period"), size = 1) +
labs(title = "Monthly Average Temperatures",
subtitle = "California, 1992-2020",
x = "Year",
y = "Temperature (°F)",
color = "Legend") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)) + # Rotate x-axis labels for clarity
scale_x_discrete(labels = monthly_temps$label) +
coord_cartesian(ylim = c(38, 80), clip = "off") +
scale_fill_gradient2(low = "yellow",
mid = "orange",
high = "red",
midpoint = overall_value_mean,
limits = c(min(monthly_temps$value, na.rm = TRUE),
max(monthly_temps$value, na.rm = TRUE)),
name = "Temperature (°F)") +
scale_color_manual(values = c("Moving Average" = "darkred",
"Mean for Period" = "darkblue"))
print(monthly_barplot)
#-------------------------------------------------------------------------------
# Monthly Data
monthly_barplot <- ggplot(monthly_temps, aes(x = year_month, y = value, fill = value)) +
geom_col(width = 1) +  # width = 1 for no gaps
geom_line(aes(y = temp_mv_avg, group = 1, color = "Moving Average"), size = 1) +
geom_line(aes(y = overall_value_mean, group = 1, color = "Mean for Period"), size = 1) +
labs(title = "Monthly Average Temperatures",
subtitle = "California, 1992-2020",
x = "Year",
y = "Temperature (°F)",
color = "Legend") +
theme_minimal() +
theme(plot.background = element_rect(fill = "grey", color = "grey"),  # Set background to grey
panel.background = element_rect(fill = "grey", color = "grey"),  # Match panel background
text = element_text(color = "black"),  # Change text color to black for visibility
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "bottom",
plot.title = element_text(face = "bold", size = 14),
axis.title = element_text(size = 12)) + # Rotate x-axis labels for clarity
scale_x_discrete(labels = monthly_temps$label) +
coord_cartesian(ylim = c(38, 80), clip = "off") +
scale_fill_gradient2(low = "yellow",
mid = "orange",
high = "red",
midpoint = overall_value_mean,
limits = c(min(monthly_temps$value, na.rm = TRUE),
max(monthly_temps$value, na.rm = TRUE)),
name = "Temperature (°F)") +
scale_color_manual(values = c("Moving Average" = "darkred",
"Mean for Period" = "darkblue"))
print(monthly_barplot)
#-------------------------------------------------------------------------------
# Monthly Data
monthly_barplot <- ggplot(monthly_temps, aes(x = year_month, y = value, fill = value)) +
geom_col(width = 1) +  # width = 1 for no gaps
geom_line(aes(y = temp_mv_avg, group = 1, color = "Moving Average"), size = 1) +
geom_line(aes(y = overall_value_mean, group = 1, color = "Mean for Period"), size = 1) +
labs(title = "Monthly Average Temperatures",
subtitle = "California, 1992-2020",
x = "Year",
y = "Temperature (°F)",
color = "Legend") +
theme_minimal() +
theme(plot.background = element_rect(fill = "grey", color = "grey"),  # Set background to grey
panel.background = element_rect(fill = "grey", color = "grey"),  # Match panel background
text = element_text(color = "black"),  # Change text color to black for visibility
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "right",
plot.title = element_text(face = "bold", size = 14),
axis.title = element_text(size = 12)) + # Rotate x-axis labels for clarity
scale_x_discrete(labels = monthly_temps$label) +
coord_cartesian(ylim = c(38, 80), clip = "off") +
scale_fill_gradient2(low = "yellow",
mid = "orange",
high = "red",
midpoint = overall_value_mean,
limits = c(min(monthly_temps$value, na.rm = TRUE),
max(monthly_temps$value, na.rm = TRUE)),
name = "Temperature (°F)") +
scale_color_manual(values = c("Moving Average" = "darkred",
"Mean for Period" = "darkblue"))
print(monthly_barplot)
#-------------------------------------------------------------------------------
# Monthly Data
monthly_barplot <- ggplot(monthly_temps, aes(x = year_month, y = value, fill = value)) +
geom_col(width = 1) +  # width = 1 for no gaps
geom_line(aes(y = temp_mv_avg, group = 1, color = "Moving Average"), size = 1) +
geom_line(aes(y = overall_value_mean, group = 1, color = "Mean for Period"), size = 1) +
labs(title = "Monthly Average Temperatures",
subtitle = "California, 1992-2020",
x = "Year",
y = "Temperature (°F)",
color = "Legend") +
theme_minimal() +
theme(plot.background = element_rect(fill = "grey", color = "grey"),  # Set background to grey
panel.background = element_rect(fill = "grey", color = "grey"),  # Match panel background
text = element_text(color = "black"),  # Change text color to black for visibility
axis.text.x = element_text(angle = 90, hjust = 1),
legend.position = "right",
plot.title = element_text(face = "bold", size = 14),
axis.title = element_text(size = 12)) + # Rotate x-axis labels for clarity
scale_x_discrete(labels = monthly_temps$label) +
coord_cartesian(ylim = c(38, 80), clip = "off") +
scale_fill_gradient2(low = "yellow",
mid = "orange",
high = "red",
midpoint = overall_value_mean,
limits = c(min(monthly_temps$value, na.rm = TRUE),
max(monthly_temps$value, na.rm = TRUE)),
name = "Temperature (°F)") +
scale_color_manual(values = c("Moving Average" = "darkred",
"Mean for Period" = "darkblue"))
print(monthly_barplot)
#-------------------------------------------------------------------------------
# Annual Data
annual_barplot <- ggplot(annual_temps, aes(x = year, y = annual_mean, fill = annual_mean)) +
geom_col(width = 1) +
geom_line(aes(y = moving_avg, group = 1, color = "Moving Average"), size = 1) +
geom_line(aes(y = overall_value_mean, group = 1, color = "Mean for Period"), size = 1) +
labs(title = "Annual Average Temperatures",
subtitle = "California, 1992-2020",
x = "Year",
y = "Temperature (°F)",
color = "Legend") +
theme_minimal() +
theme(plot.background = element_rect(fill = "grey", color = "grey"),  # Set background to grey
panel.background = element_rect(fill = "grey", color = "grey"),  # Match panel background
text = element_text(color = "black"),  # Change text color to black for visibility
axis.text.x = element_text(angle = 90, hjust = 1),
legend.position = "right",
plot.title = element_text(face = "bold", size = 14),
axis.title = element_text(size = 12)) +
scale_x_discrete(labels = annual_temps$label) +
coord_cartesian(ylim = c(55, 63), clip = "off") +
scale_fill_gradient2(low = "yellow",
mid = "orange",
high = "red",
midpoint = overall_value_mean,
limits = c(min(annual_temps$annual_mean, na.rm = TRUE),
max(annual_temps$annual_mean, na.rm = TRUE)),
name = "Temperature (°F)") +
scale_color_manual(values = c("Moving Average" = "darkred",
"Mean for Period" = "darkblue"))
print(annual_barplot)
head(annual_temps, 12)
annual_temps <- monthly_temps %>%
select(year, value, label) %>%
group_by(year) %>%
summarise(annual_mean = mean(value, na.rm = TRUE),
label = as.integer(first(label)),
.groups = 'drop')
# Calculate moving average (didn't work in summarise())
annual_temps <- annual_temps %>%
mutate(moving_avg = rollmean(annual_mean, k = 5, fill = NA, align = 'center'))
head(annual_temps, 12)
#-------------------------------------------------------------------------------
# Annual Data
annual_barplot <- ggplot(annual_temps, aes(x = year, y = annual_mean, fill = annual_mean)) +
geom_col(width = 1) +
geom_line(aes(y = moving_avg, group = 1, color = "Moving Average"), size = 1) +
geom_line(aes(y = overall_value_mean, group = 1, color = "Mean for Period"), size = 1) +
labs(title = "Annual Average Temperatures",
subtitle = "California, 1992-2020",
x = "Year",
y = "Temperature (°F)",
color = "Legend") +
theme_minimal() +
theme(plot.background = element_rect(fill = "grey", color = "grey"),  # Set background to grey
panel.background = element_rect(fill = "grey", color = "grey"),  # Match panel background
text = element_text(color = "black"),  # Change text color to black for visibility
axis.text.x = element_text(angle = 90, hjust = 1),
legend.position = "right",
plot.title = element_text(face = "bold", size = 14),
axis.title = element_text(size = 12)) +
scale_x_discrete(labels = annual_temps$label) +
coord_cartesian(ylim = c(55, 63), clip = "off") +
scale_fill_gradient2(low = "yellow",
mid = "orange",
high = "red",
midpoint = overall_value_mean,
limits = c(min(annual_temps$annual_mean, na.rm = TRUE),
max(annual_temps$annual_mean, na.rm = TRUE)),
name = "Temperature (°F)") +
scale_color_manual(values = c("Moving Average" = "darkred",
"Mean for Period" = "darkblue"))
print(annual_barplot)
head(annual_temps, 15)
#-------------------------------------------------------------------------------
# Annual Data
annual_barplot <- ggplot(annual_temps, aes(x = year, y = annual_mean, fill = annual_mean)) +
geom_col(width = 1) +
geom_line(aes(y = moving_avg, group = 1, color = "Moving Average"), size = 1) +
geom_line(aes(y = overall_value_mean, group = 1, color = "Mean for Period"), size = 1) +
labs(title = "Annual Average Temperatures",
subtitle = "California, 1992-2020",
x = "Year",
y = "Temperature (°F)",
color = "Legend") +
theme_minimal() +
theme(plot.background = element_rect(fill = "grey", color = "grey"),  # Set background to grey
panel.background = element_rect(fill = "grey", color = "grey"),  # Match panel background
text = element_text(color = "black"),  # Change text color to black for visibility
axis.text.x = element_text(angle = 90, hjust = 1),
legend.position = "right",
plot.title = element_text(face = "bold", size = 14),
axis.title = element_text(size = 12)) +
scale_x_discrete(labels = setNames(as.character(annual_temps$label), annual_temps$year)) +
coord_cartesian(ylim = c(55, 63), clip = "off") +
scale_fill_gradient2(low = "yellow",
mid = "orange",
high = "red",
midpoint = overall_value_mean,
limits = c(min(annual_temps$annual_mean, na.rm = TRUE),
max(annual_temps$annual_mean, na.rm = TRUE)),
name = "Temperature (°F)") +
scale_color_manual(values = c("Moving Average" = "darkred",
"Mean for Period" = "darkblue"))
print(annual_barplot)
#-------------------------------------------------------------------------------
# Monthly Data
monthly_barplot <- ggplot(monthly_temps, aes(x = year_month, y = value, fill = value)) +
geom_col(width = 1) +  # width = 1 for no gaps
geom_line(aes(y = temp_mv_avg, group = 1, color = "Moving Average"), size = 1) +
geom_line(aes(y = overall_value_mean, group = 1, color = "Mean for Period"), size = 1) +
labs(title = "Monthly Average Temperatures",
subtitle = "California, 1992-2020",
x = "Year",
y = "Temperature (°F)",
color = "Legend") +
theme_minimal() +
theme(plot.background = element_rect(fill = "grey", color = "grey"),  # Set background to grey
panel.background = element_rect(fill = "grey", color = "grey"),  # Match panel background
text = element_text(color = "black"),  # Change text color to black for visibility
axis.text.x = element_text(angle = 90, hjust = 1),
legend.position = "right",
plot.title = element_text(face = "bold", size = 14),
axis.title = element_text(size = 12)) + # Rotate x-axis labels for clarity
scale_x_discrete(labels = monthly_temps$label) +
coord_cartesian(ylim = c(38, 80), clip = "off") +
scale_fill_gradient2(low = "yellow",
mid = "orange",
high = "red",
midpoint = overall_value_mean,
limits = c(min(monthly_temps$value, na.rm = TRUE),
max(monthly_temps$value, na.rm = TRUE)),
name = "Temperature (°F)") +
scale_color_manual(values = c("Moving Average" = "darkred",
"Mean for Period" = "darkblue"))
print(monthly_barplot)
annual_temps <- monthly_temps %>%
select(year, value, label) %>%
group_by(year) %>%
summarise(annual_mean = mean(value, na.rm = TRUE),
label = first(label),
.groups = 'drop')
# Calculate moving average (didn't work in summarise())
annual_temps <- annual_temps %>%
mutate(moving_avg = rollmean(annual_mean, k = 5, fill = NA, align = 'center'))
str(annual_temps)
head(annual_temps, 12)
annual_barplot <- ggplot(annual_temps, aes(x = year, y = annual_mean, fill = annual_mean)) +
geom_col(width = 1) +
geom_line(aes(y = moving_avg, group = 1, color = "Moving Average"), size = 1) +
geom_line(aes(y = overall_value_mean, group = 1, color = "Mean for Period"), size = 1) +
labs(title = "Annual Average Temperatures",
subtitle = "California, 1992-2020",
x = "Year",
y = "Temperature (°F)",
color = "Legend") +
theme_minimal() +
theme(plot.background = element_rect(fill = "grey", color = "grey"),  # Set background to grey
panel.background = element_rect(fill = "grey", color = "grey"),  # Match panel background
text = element_text(color = "black"),  # Change text color to black for visibility
axis.text.x = element_text(angle = 90, hjust = 1),
legend.position = "right",
plot.title = element_text(face = "bold", size = 14),
axis.title = element_text(size = 12)) +
scale_x_discrete(labels = annual_temps$label) +
coord_cartesian(ylim = c(55, 63), clip = "off") +
scale_fill_gradient2(low = "yellow",
mid = "orange",
high = "red",
midpoint = overall_value_mean,
limits = c(min(annual_temps$annual_mean, na.rm = TRUE),
max(annual_temps$annual_mean, na.rm = TRUE)),
name = "Temperature (°F)") +
scale_color_manual(values = c("Moving Average" = "darkred",
"Mean for Period" = "darkblue"))
print(annual_barplot)
